<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Spring知识点 | Supertramp</title><meta name="keywords" content="ssh,java,spring,框架"><meta name="author" content="supertramp"><meta name="copyright" content="supertramp"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Spring 概念 1 spring是开源的轻量级框架 2 spring核心主要两部分： 1）ioc：控制反转，比如有一个类，在类里面有方法（不是静态方法），创建类的对象，使用对象调用方法，创建类对象的过程，需要new出来对象 把对象的创建不是通过new方式实现，而是交给spring配置创建类对象 2）aop：面向切面编程，扩展功能不是修改源代码实现 3 spring是一站式框架 1）spring">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring知识点">
<meta property="og:url" content="https://supertramp7.github.io/spring/index.html">
<meta property="og:site_name" content="Supertramp">
<meta property="og:description" content="Spring 概念 1 spring是开源的轻量级框架 2 spring核心主要两部分： 1）ioc：控制反转，比如有一个类，在类里面有方法（不是静态方法），创建类的对象，使用对象调用方法，创建类对象的过程，需要new出来对象 把对象的创建不是通过new方式实现，而是交给spring配置创建类对象 2）aop：面向切面编程，扩展功能不是修改源代码实现 3 spring是一站式框架 1）spring">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://supertramp7.github.io/spring/spring.png">
<meta property="article:published_time" content="2022-03-08T00:54:30.000Z">
<meta property="article:modified_time" content="2022-04-06T12:19:38.736Z">
<meta property="article:author" content="supertramp">
<meta property="article:tag" content="ssh">
<meta property="article:tag" content="java">
<meta property="article:tag" content="spring">
<meta property="article:tag" content="框架">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://supertramp7.github.io/spring/spring.png"><link rel="shortcut icon" href="/assets/favicon.png"><link rel="canonical" href="https://supertramp7.github.io/spring/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":100},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Spring知识点',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-06 20:19:38'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/assets/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-times"></i><span> Daily</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/404.html"><i class="fa-fw fas fa-exclamation"></i><span> 404</span></a></li><li><a class="site-page child" href="/daily/mood/"><i class="fa-fw fas fa-comment"></i><span> Mood</span></a></li><li><a class="site-page child" href="/daily/study/"><i class="fa-fw fas fa-book"></i><span> Study</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/spring/spring.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Supertramp</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-times"></i><span> Daily</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/404.html"><i class="fa-fw fas fa-exclamation"></i><span> 404</span></a></li><li><a class="site-page child" href="/daily/mood/"><i class="fa-fw fas fa-comment"></i><span> Mood</span></a></li><li><a class="site-page child" href="/daily/study/"><i class="fa-fw fas fa-book"></i><span> Study</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Spring知识点</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-08T00:54:30.000Z" title="发表于 2022-03-08 08:54:30">2022-03-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-06T12:19:38.736Z" title="更新于 2022-04-06 20:19:38">2022-04-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java/">java</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Spring-概念"><a href="#Spring-概念" class="headerlink" title="Spring 概念"></a>Spring 概念</h1><blockquote>
<p>1 spring是开源的轻量级框架</p>
<p>2 spring核心主要两部分：</p>
<p>1）ioc：控制反转，比如有一个类，在类里面有方法（不是静态方法），创建类的对象，使用对象调用方法，创建类对象的过程，需要new出来对象</p>
<p>把对象的创建不是通过new方式实现，而是交给spring配置创建类对象</p>
<p>2）aop：面向切面编程，扩展功能不是修改源代码实现</p>
<p>3 spring是一站式框架</p>
<p>1）spring 在 javaee三层结构中，每一层都提供不同的解决技术</p>
<p>web：springMVC</p>
<p>service：spring的ioc</p>
<p>dao：spring的jdbcTemplate</p>
<p>4 spring版本</p>
<p>hibernate5.x</p>
<p>spring4.x</p>
</blockquote>
<h1 id="Spring的ioc操作"><a href="#Spring的ioc操作" class="headerlink" title="Spring的ioc操作"></a>Spring的ioc操作</h1><blockquote>
<p>1 把对象的创建交给spring进行管理</p>
<p>2 ioc操作两部分：</p>
<p>1）ioc的配置文件方式</p>
<p>2）ioc的注解方式</p>
</blockquote>
<h2 id="ioc底层原理"><a href="#ioc底层原理" class="headerlink" title="ioc底层原理"></a>ioc底层原理</h2><p><strong>1 ioc底层原理使用技术</strong></p>
<p>1）xml配置文件</p>
<p>2）dom4j解决xml</p>
<p>3）工厂设计模式</p>
<p>4）反射</p>
<p><strong>2 图解</strong></p>
<p>ioc过程1：</p>
<p><img src="/spring/2022-03-08_092635.png" alt="ioc过程1"></p>
<p>ioc过程2：</p>
<p><img src="/spring/2022-03-08_093716.png" alt="ioc过程2"></p>
<h2 id="ioc入门案例"><a href="#ioc入门案例" class="headerlink" title="ioc入门案例"></a>ioc入门案例</h2><p><strong>第一步 导入jar包</strong></p>
<p><strong>第二步 创建类，在类里面创建方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//		 原始方法</span></span><br><span class="line">		User user = <span class="keyword">new</span> User();</span><br><span class="line">		user.add();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>第三步 创建spring配置文件，配置创建类</strong></p>
<p>1）spring核心配置文件名称和位置不是固定的，建议放在src下面，官方建议applicationContext.xml</p>
<p>2）引入schema约束</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">           http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">            http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">           http://www.springframework.org/schema/context/spring-context-3.2.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd&quot;</span></span></span><br><span class="line"><span class="tag">           </span></span><br><span class="line"><span class="tag">           </span></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>3）配置对象创建</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ioc入门 --&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.ioc.User&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>第四步 写代码测试对象创建</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 1. 加载spring配置文件，根据创建对象</span></span><br><span class="line">	ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;application.xml&quot;</span>);</span><br><span class="line">	<span class="comment">// 2. 得到配置创建的对象</span></span><br><span class="line">	User user = (User)context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">	System.out.println(user);</span><br><span class="line">	user.add();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="配置文件没有提示问题"><a href="#配置文件没有提示问题" class="headerlink" title="配置文件没有提示问题"></a>配置文件没有提示问题</h2><p>spring引入schema约束，把约束文件引入到eclipse中</p>
<p>1）复制约束路径</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</span><br></pre></td></tr></table></figure>

<p>2）引入到eclipse中</p>
<p><img src="/spring/2022-03-10_082158.png" alt="引入到eclipse中"></p>
<h1 id="Spring的bean管理（xml配置文件）"><a href="#Spring的bean管理（xml配置文件）" class="headerlink" title="Spring的bean管理（xml配置文件）"></a>Spring的bean管理（xml配置文件）</h1><blockquote>
<p>1 bean实例化三种方式</p>
<p>2 bean标签常用属性</p>
<p>3 属性注入方式介绍</p>
<p>4 spring注入属性（有参构造和set方法）</p>
<p>5 spring注入对象类型属性（重点）</p>
<p>6 p名称空间注入</p>
<p>7 spring注入复杂数据</p>
</blockquote>
<h2 id="bean实例化三种方式"><a href="#bean实例化三种方式" class="headerlink" title="bean实例化三种方式"></a>bean实例化三种方式</h2><blockquote>
<p>在spring里面通过配置文件创建对象</p>
</blockquote>
<p><strong>第一种 使用类的无参构造创建（重点）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ioc入门 --&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.ioc.User&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>类里面没有无参构造，出现异常</p>
<p><strong>第二种 使用静态工厂创建</strong></p>
<p>1）创建静态的方法，返回类对象</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用静态工厂创建对象 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bean2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.bean.Bean2Factory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getBean2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>第三种 使用实例工厂创建</strong></p>
<p>1）创建不是静态的方法，返回类对象</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用实例工厂创建对象 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 1、创建工厂对象 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bean3Factory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.bean3.Bean3Factory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 2、创建对象 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bean3&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;bean3Factory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getBean3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br></pre></td></tr></table></figure>



<h2 id="bean标签常用属性"><a href="#bean标签常用属性" class="headerlink" title="bean标签常用属性"></a>bean标签常用属性</h2><p><strong>1）id属性</strong> - 起名称，id属性值名称任意命名</p>
<p>id属性值，不能包含特殊符号</p>
<p>根据id值得到配置对象</p>
<p><strong>2）class属性</strong> - 创建对象所在类的全路径</p>
<p><strong>3）name属性</strong> - 功能和id属性一样，但是name属性值里可以包含特殊符号</p>
<p><strong>4）scope属性</strong></p>
<p><strong>-singleton</strong>：默认值，单例</p>
<p><strong>-prototype</strong>：多例</p>
<p>-request：创建对象把对象放到request域里面</p>
<p>-session：创建对象把对象放到session域里面</p>
<p>-globalSession：创建对象把对象放到globalSession域里面</p>
<h2 id="属性注入方式介绍"><a href="#属性注入方式介绍" class="headerlink" title="属性注入方式介绍"></a>属性注入方式介绍</h2><blockquote>
<p>创建对象时，向类的属性里面设置值</p>
</blockquote>
<p><strong>在Java中：</strong></p>
<p><strong>1）使用有参构造注入</strong></p>
<p><img src="/spring/2022-03-10_091817.png" alt="使用有参构造注入"></p>
<p><strong>2）使用set()注入</strong></p>
<p><img src="/spring/2022-03-10_091644.png" alt="使用set()注入"></p>
<p><strong>3）使用接口注入</strong></p>
<p><img src="/spring/2022-03-10_091921.png" alt="使用接口注入"></p>
<h2 id="Spring注入属性（有参构造和set方法）"><a href="#Spring注入属性（有参构造和set方法）" class="headerlink" title="Spring注入属性（有参构造和set方法）"></a>Spring注入属性（有参构造和set方法）</h2><p><strong>在Spring框架里面，支持前两种方式</strong></p>
<p><strong>1）有参构造注入</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用有参构造注入属性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;demo1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.property.PropertyDemo1&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 使用有参构造注入 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lili&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>2）set()注入（重点）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用set方法注入属性 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;book&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.property.Book&quot;</span>&gt;</span></span><br><span class="line">   	<span class="comment">&lt;!-- 注入属性值</span></span><br><span class="line"><span class="comment">   		name属性值：类里面定义的属性名称</span></span><br><span class="line"><span class="comment">   		value属性：设置具体的值</span></span><br><span class="line"><span class="comment">   	 --&gt;</span></span><br><span class="line">   	 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;被讨厌的勇气&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Spring注入对象类型属性（重点）"><a href="#Spring注入对象类型属性（重点）" class="headerlink" title="Spring注入对象类型属性（重点）"></a>Spring注入对象类型属性（重点）</h2><blockquote>
<p>创建service类和dao类</p>
<p>在service得到dao对象</p>
</blockquote>
<p><strong>具体实现过程</strong></p>
<p>1）在service里面把dao作为类型属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 定义dao类型属性</span></span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 生成set方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2）生成dao类型属性的set方法</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注入对象类型属性 --&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 1 配置service和dao对象 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.ioc.UserDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.ioc.UserService&quot;</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- 2 注入dao对象 </span></span><br><span class="line"><span class="comment">       	name属性值：service类里面属性名称</span></span><br><span class="line"><span class="comment">       	现在是对象，不写value属性</span></span><br><span class="line"><span class="comment">       	写ref属性：dao配置bean标签中id值</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="P名称空间注入"><a href="#P名称空间注入" class="headerlink" title="P名称空间注入"></a>P名称空间注入</h2><p><strong>1）添加beans属性</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:p&#x3D;&quot;http:&#x2F;&#x2F;www.springframework.org&#x2F;schema&#x2F;p&quot;</span><br></pre></td></tr></table></figure>



<p><strong>2）P名称空间注入</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- P名称空间注入 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.property.Person&quot;</span> <span class="attr">p:pname</span>=<span class="string">&quot;jennie&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Spring注入复杂数据"><a href="#Spring注入复杂数据" class="headerlink" title="Spring注入复杂数据"></a>Spring注入复杂数据</h2><blockquote>
<p>1 数组类型</p>
<p>2 List集合</p>
<p>3 map集合</p>
<p>4 properties类型</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注入复杂数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.z.property.Person&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 数组 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;arrs&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>lili<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>rose<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>jisoo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- list --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>lili2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>rose2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>jisoo2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- map --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;11&quot;</span> <span class="attr">value</span>=<span class="string">&quot;111&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;22&quot;</span> <span class="attr">value</span>=<span class="string">&quot;222&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;33&quot;</span> <span class="attr">value</span>=<span class="string">&quot;333&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- properties --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;driverclass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="IOC和DI区别"><a href="#IOC和DI区别" class="headerlink" title="IOC和DI区别"></a>IOC和DI区别</h2><p><strong>1）IOC：控制反转，把对象创建交给spring进行配置</strong></p>
<p><strong>2）DI：依赖注入，向类里面的属性中设置值</strong></p>
<p><strong>3）关系：依赖注入不能单独存在，需要在ioc的基础之上操作</strong></p>
<h1 id="Spring整合web项目原理"><a href="#Spring整合web项目原理" class="headerlink" title="Spring整合web项目原理"></a>Spring整合web项目原理</h1><p><strong>1 加载spring核心配置文件</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;application.xml&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>1）new对象，功能可以实现，效率很低</p>
<p><strong>2 实现思想：把加载配置文件和创建对象过程，在服务器启动时候完成</strong></p>
<p><strong>3 实现原理</strong></p>
<p>1）ServletContext对象</p>
<p>2）监听器</p>
<p>3）具体使用：</p>
<p>-在服务器启动时，为每个项目创建一个ServletContext对象</p>
<p>-在ServletContext对象创建时，使用监听器可以具体到ServletContext对象在什么时候创建</p>
<p>-使用监听器监听到ServletContext对象创建时候，</p>
<p>​    –加载spring配置文件，把配置文件配置对象创建</p>
<p>​    –把创建出来的对象放到ServletContext域对象里面（setAttribute方法）</p>
<p>-获取对象时，到ServletContext域得到（getAttribute方法）</p>
<h1 id="Spring的bean管理（注解）"><a href="#Spring的bean管理（注解）" class="headerlink" title="Spring的bean管理（注解）"></a>Spring的bean管理（注解）</h1><blockquote>
<p>注解介绍</p>
<p>1 代码里面特殊标记，使用注解可以完成功能</p>
<p>2 注解写法 @注解名称(属性名称=属性值)</p>
<p>3 注解使用在类上面，方法上面和属性上面</p>
</blockquote>
<h2 id="Spring注解开发准备"><a href="#Spring注解开发准备" class="headerlink" title="Spring注解开发准备"></a>Spring注解开发准备</h2><p><strong>1 导入jar包</strong></p>
<p>1）导入基本的jar包</p>
<p>2）导入aop的jar包</p>
<p><strong>2 创建类，创建方法</strong> </p>
<p><strong>3 创建spring配置文件，引入约束</strong></p>
<p>1）做ioc基本功能，引入约束</p>
<p>2）做spring的ioc注解开发，引入新的约束</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.springframework.org/schema/context/spring-context-3.2.xsd</span><br></pre></td></tr></table></figure>

<p><strong>4 开启注解扫描</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开启注解扫描(jdk1.8不支持)</span></span><br><span class="line"><span class="comment">	1）到包里面扫描类、方法、属性上面是否有注解</span></span><br><span class="line"><span class="comment"> --&gt;</span>	</span><br><span class="line"> <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"> <span class="comment">&lt;!-- 扫描属性上面的注解（不常用） --&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- &lt;context:annotation-config&gt;&lt;/context:annotation-config&gt; --&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="使用注解创建对象"><a href="#使用注解创建对象" class="headerlink" title="使用注解创建对象"></a>使用注解创建对象</h2><p><strong>1 在创建对象的类上面使用注解实现</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value=&quot;user&quot;)</span>   <span class="comment">// &lt;bean id=&quot;user&quot; class=&quot;com.z.anno.User&quot;&gt;&lt;/bean&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">&quot;add....&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>2 创建对象有四个注解</strong></p>
<p><img src="/spring/2022-03-10_234543.png" alt="创建对象有四个注解"></p>
<p>1）@Component</p>
<p>2）@Controller</p>
<p>3）@Service</p>
<p>4）@Repository</p>
<p>目前这四个注解功能是一样的，都创建对象</p>
<p><strong>3 创建对象单实例还是多实例,@Scope</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value=&quot;user&quot;)</span></span><br><span class="line"><span class="meta">@Scope(value=&quot;propertype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">&quot;add....&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="使用注解注入属性"><a href="#使用注解注入属性" class="headerlink" title="使用注解注入属性"></a>使用注解注入属性</h2><blockquote>
<p>需求：创建service类，创建dao类，在service得到dao对象</p>
<p>1）创建dao和service对象</p>
<p>2）在service类里面定义dao类型属性</p>
</blockquote>
<p><strong>第一个：属性注解@Autowired - 自动注入</strong> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">UserDao.java</span><br><span class="line"><span class="meta">@Component(value=&quot;userDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;....UserDao...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">UserService.java</span><br><span class="line"><span class="meta">@Service(value=&quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//首先定义dao类型属性，然后使用注解完成对象注入</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="comment">// 使用注解方式不需要set方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UserService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;......userService.....&quot;</span>);</span><br><span class="line">        userDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>第二个：属性注解@Resource - 准确指定描述对象</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">UserService.java</span><br><span class="line"><span class="meta">@Service(value=&quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//首先定义dao类型属性，然后使用注解完成对象注入</span></span><br><span class="line">    <span class="comment">//@Autowired</span></span><br><span class="line">    <span class="comment">//private UserDao userDao;</span></span><br><span class="line">    <span class="comment">// 使用注解方式不需要set方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// name是dao里面@Component(value=&quot;userDao&quot;)</span></span><br><span class="line">    <span class="meta">@Resource(name=&quot;userDao&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UserService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;......userService.....&quot;</span>);</span><br><span class="line">        userDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="xml和注解方式混合使用"><a href="#xml和注解方式混合使用" class="headerlink" title="xml和注解方式混合使用"></a>xml和注解方式混合使用</h2><p><strong>1 创建对象操作使用<em>配置文件</em>方式实现</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开启注解式扫描，检测包里面扫描类，方法，属性是否有注解 --&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.neuedu&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 创建对象 --&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.neuedu.user2.BookDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.neuedu.user2.OrderDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.neuedu.user2.BookService&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>2 注入属性的操作使用<em>注解方式</em>实现</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Resource(name=&quot;bookDao&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Resource(name=&quot;orderDao&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> OrderDao orderDao;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BookService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;.....BookService....&quot;</span>);</span><br><span class="line">        bookDao.BookDao();</span><br><span class="line">        orderDao.OrederDao();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><blockquote>
<p>1 aop概述</p>
<p>2 aop底层原理</p>
<p>3 aop操作相关术语</p>
</blockquote>
<h2 id="AOP概念"><a href="#AOP概念" class="headerlink" title="AOP概念"></a>AOP概念</h2><p>1 AOP：面向切面（方面）编程，扩展功能不修改源代码实现<br>2 AOP采取<strong>横向抽取机制</strong>，取代了传统<strong>纵向继承</strong>体系重复性代码<br>3 AOP底层使用动态代理实现<br> （1）第一种情况，有接口情况，使用动态代理创建接口实现类代理对象<br> （2）第二种情况，没有接口情况，使用动态代理创建类的子类代理对象</p>
<h2 id="AOP原理"><a href="#AOP原理" class="headerlink" title="AOP原理"></a>AOP原理</h2><p><strong>1）纵向继承机制解决</strong></p>
<p><img src="/spring/2022-03-11_002148.png" alt="纵向继承"></p>
<p><strong>2）横向抽取机制</strong></p>
<p><img src="/spring/2022-03-11_002814.png" alt="横向抽取机制"></p>
<h2 id="AOP操作术语"><a href="#AOP操作术语" class="headerlink" title="AOP操作术语"></a>AOP操作术语</h2><p><strong>Joinpoint(连接点):</strong> 类里面可以被增强的方法，这些方法称为连接点</p>
<p> ***Pointcut(切入点):**所谓切入点是指我们要对哪些Joinpoint进行拦截的定义</p>
<p> ***Advice(通知/增强):**所谓通知是指拦截到Joinpoint之后所要做的事情就是通知.通知分为前置通知,后置通知,异常通知,最终通知,环绕通知(切面要完成的功能)</p>
<p> ***Aspect(切面):**是切入点和通知（引介）的结合</p>
<p> **Introduction(引介):**引介是一种特殊的通知在不修改类代码的前提下, Introduction可以在运行期为类动态地添加一些方法或Field</p>
<p>**Target(目标对象):**代理的目标对象(要增强的类)</p>
<p> **Weaving(织入):**是把增强应用到目标的过程</p>
<p>​                             把advice 应用到 target的过程</p>
<p>**Proxy(代理):**一个类被AOP织入增强后，就产生一个结果代表类</p>
<p><img src="/spring/2022-03-11_003438.png" alt="AOP操作术语"></p>
<h1 id="Spirng的AOP操作（基于aspectj的xml方式）"><a href="#Spirng的AOP操作（基于aspectj的xml方式）" class="headerlink" title="Spirng的AOP操作（基于aspectj的xml方式）"></a>Spirng的AOP操作（基于aspectj的xml方式）</h1><blockquote>
<p>*<em>1 在spring里面进行aop操作，使用 <em>aspectj</em>实现</em>*</p>
<p>1）aspectj不是spring一部分，和spring一起使用进行aop操作</p>
<p>2）Spring2.0以后新增了对AspectJ支持</p>
<p><strong>2 使用aspectj实现aop有两种方式</strong></p>
<p>1）基于aspectj的xml配置</p>
<p>2）基于aspectj的注解方式</p>
</blockquote>
<h2 id="AOP操作准备"><a href="#AOP操作准备" class="headerlink" title="AOP操作准备"></a>AOP操作准备</h2><p><strong>1 导入aop相关jar包</strong></p>
<p><strong>2 创建spring核心配置文件，导入aop约束</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd</span><br></pre></td></tr></table></figure>



<h2 id="使用表达式配置切入点"><a href="#使用表达式配置切入点" class="headerlink" title="使用表达式配置切入点"></a>使用表达式配置切入点</h2><p><strong>1 切入点：实际增强的方法</strong></p>
<p><strong>2 常用的表达式</strong></p>
<p>execution(&lt;访问修饰符&gt;?&lt;返回类型&gt;&lt;方法名&gt;(&lt;参数&gt;)&lt;异常&gt;)</p>
<p> 1）execution(* cn.itcast.aop.Book.add(..))</p>
<p>含义：任意修饰符,在cn.itcast.aop包下Book类中add方法(),有参数也包含</p>
<p> 2）execution(* cn.itcast.aop.Book.*(..))</p>
<p> 含义：任意修饰符,在cn.itcast.aop包下Book类中所有方法(),有参数也包含</p>
<p> 3）execution(* /<em>./</em>(..))</p>
<p> 含义：任意修饰符,在所有类下所有方法,有参数也包含</p>
<p> 4） 匹配所有save开头的方法 execution(* save*(..))</p>
<p> 含义：任意修饰符，以save开头的任意方法都增强,有参数也包含</p>
<p><strong>AspectJ的aop操作</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1.配置对象 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;book&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.neuedu.aop.Book&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myBook&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.neuedu.aop.MyBook&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2.配置Aop操作 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 2.1配置切入点 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.neuedu.aop.Book.*(..))&quot;</span> <span class="attr">id</span>=<span class="string">&quot;qieru&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 2.2配置切面，把增强用到方法上面 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myBook&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 2.3配置增强类型method：增强类里面使用哪个方法作为前置--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;before1&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;qieru&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 后置增强 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">&quot;after1&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;qieru&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 环绕通知 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;around1&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;qieru&quot;</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>3 AspectJ支持5种类型的通知注解:</strong></p>
<p>@Before:前置通知，在方法执行之前返回</p>
<p> @After:后置通知，在方法执行后执行</p>
<p> @AfterRunning:返回通知，在方法返回结果之后执行</p>
<p> @AfterThrowing:异常通知，在方法抛出异常之后</p>
<p> @Around:环绕通知，围绕着方法执行</p>
<h1 id="log4j介绍"><a href="#log4j介绍" class="headerlink" title="log4j介绍"></a>log4j介绍</h1><p><strong>1 通过log4j可以看到程序运行过程中更详细的信息</strong></p>
<p>1）经常使用log4j查看日志</p>
<p><strong>2 使用</strong></p>
<p>1）导入jar包</p>
<p>2）复制log4j配置文件到src下面</p>
<p><strong>3 设置日志级别</strong></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">info,debug	</span></span><br></pre></td></tr></table></figure>

<p>1）info：看到基本信息</p>
<p>2）debug：看到更详细信息</p>
<h1 id="Spring整合web项目演示"><a href="#Spring整合web项目演示" class="headerlink" title="Spring整合web项目演示"></a>Spring整合web项目演示</h1><p><strong>1 演示问题</strong></p>
<p>1）action调用service，service调用dao</p>
<p>每次访问action时候，都会加载spring配置文件</p>
<p><strong>2 解决方案</strong></p>
<p>1）在服务器启动时候，创建对象加载配置文件</p>
<p>2）底层使用监听器、ServletContext对象</p>
<p><strong>3 在spring里面不需要我们自己写代码实现，帮封装</strong></p>
<p>1）封装了一个监听器，只需要配置监听器就可以了</p>
<p>2）配置监听器之前做事情：导入spring整合web项目jar包</p>
<p>spring-web-3.2.0.RELEASE.jar</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置监听器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3）指定加载spring配置文件位置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    指定spring配置文件位置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:bean1.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="Spirng的AOP操作（基于aspectj的注解aop）"><a href="#Spirng的AOP操作（基于aspectj的注解aop）" class="headerlink" title="Spirng的AOP操作（基于aspectj的注解aop）"></a>Spirng的AOP操作（基于aspectj的注解aop）</h1><h2 id="使用注解方式实现aop操作"><a href="#使用注解方式实现aop操作" class="headerlink" title="使用注解方式实现aop操作"></a>使用注解方式实现aop操作</h2><p><strong>1）创建对象</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    创建对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;book&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.demo.aop.Book&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myBook&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.demo.aop.MyBook&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>2）在spring核心配置文件中，开启aop操作</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--   开启aop操作 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:aspectj-autoproxy</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>3） 在增强类上面使用注解完成aop操作</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.aop;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBook</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    在方法上面使用注解完成增强配置</span></span><br><span class="line">    <span class="meta">@Before(value=&quot;execution(* com.demo.aop.Book.*(..))&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;before......&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="Spring的jdbcTemplate操作"><a href="#Spring的jdbcTemplate操作" class="headerlink" title="Spring的jdbcTemplate操作"></a>Spring的jdbcTemplate操作</h1><p><strong>1 Spring框架一站式框架</strong></p>
<p>1）针对javaee三层，每一层都有解决技术</p>
<p>2）在dao层，使用 jdbcTemplate</p>
<p><strong>2 Spring对不同的持久化层技术都进行封装</strong></p>
<p><img src="/spring/Spring%E5%AF%B9%E4%B8%8D%E5%90%8C%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E5%B1%82%E6%8A%80%E6%9C%AF%E9%83%BD%E8%BF%9B%E8%A1%8C%E5%B0%81%E8%A3%85.png" alt="Spring对不同的持久化层技术都进行封装"></p>
<p>1）jdbcTemplate对jdbc进行封装</p>
<p><strong>3 jdbcTemplate使用和dbutils使用很相似，都数据库进行crud操作</strong></p>
<h2 id="增加"><a href="#增加" class="headerlink" title="增加"></a>增加</h2><p><strong>1 导入jdbcTemplate使用的jar包</strong></p>
<p><img src="/spring/%E5%AF%BC%E5%85%A5jdbcTemplate%E4%BD%BF%E7%94%A8%E7%9A%84jar%E5%8C%85.png" alt="导入jdbcTemplate使用的jar包"></p>
<p>还有数据库驱动jar包</p>
<p>mysql-connector-java-5.0.4-bin.jar</p>
<p><strong>2 创建对象，设置数据库信息</strong></p>
<p><strong>3 创建jdbcTemplate对象，设置数据源</strong></p>
<p><strong>4 调用jdbcTemplate对象里面的方法实现操作</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.DriverManagerDataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcTemplateDemo1</span> </span>&#123;</span><br><span class="line">    <span class="comment">//    1 添加操作</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 2 创建对象，设置数据库信息</span></span><br><span class="line">        DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 创建jdbcTemplate对象，设置数据源</span></span><br><span class="line">        JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 调用jdbcTemplate对象里面的方法实现操作</span></span><br><span class="line"><span class="comment">//        创建sql语句</span></span><br><span class="line">        String sql = <span class="string">&quot;insert into user values(?,?)&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> rows = jdbcTemplate.update(sql, <span class="string">&quot;jack&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line">        System.out.println(rows);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//   2 修改操作</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 2 创建对象，设置数据库信息</span></span><br><span class="line">        DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 创建jdbcTemplate对象，设置数据源</span></span><br><span class="line">        JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 调用jdbcTemplate对象里面的方法实现操作</span></span><br><span class="line"><span class="comment">//        创建sql语句</span></span><br><span class="line">        String sql = <span class="string">&quot;update user set password=? where username=?&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> rows = jdbcTemplate.update(sql, <span class="string">&quot;jack&quot;</span>, <span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        System.out.println(rows);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>





<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//   3 删除操作</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 2 创建对象，设置数据库信息</span></span><br><span class="line">        DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 创建jdbcTemplate对象，设置数据源</span></span><br><span class="line">        JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 调用jdbcTemplate对象里面的方法实现操作</span></span><br><span class="line"><span class="comment">//        创建sql语句</span></span><br><span class="line">        String sql = <span class="string">&quot;delete from user where username=?&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> rows = jdbcTemplate.update(sql, <span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        System.out.println(rows);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>





<h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><p><strong>1 使用jdbcTemplate实现查询操作</strong></p>
<p>jdbcTemplate实现查询，有接口RowMapper,</p>
<p>jdbcTemplate针对这个接口没有提供实现类，得到不同的类型数据需要自己进行数据封装</p>
<p><strong>2 查询具体实现</strong></p>
<p>第一个 查询返回某一个值</p>
<p><img src="/spring/2022-03-23_112503.png" alt="查询返回某一个值"></p>
<p>1）第一个参数是sql语句</p>
<p>2）第二个参数 返回类型的class</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    1 查询表中有多少条记录</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 2 创建对象，设置数据库信息</span></span><br><span class="line">        DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 创建jdbcTemplate对象，设置数据源</span></span><br><span class="line">        JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 调用jdbcTemplate对象里面的方法实现操作</span></span><br><span class="line"><span class="comment">//        创建sql语句</span></span><br><span class="line">        String sql = <span class="string">&quot;select count(*) from user&quot;</span>;</span><br><span class="line"><span class="comment">//        调用jdbcTemplate对象里面的方法实现操作</span></span><br><span class="line">        <span class="keyword">int</span> count = jdbcTemplate.queryForObject(sql, Integer.class);</span><br><span class="line">        System.out.println(count);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>





<p>第二个 查询返回对象</p>
<p>jdbc原始实现代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    2 jdbc实现代码</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJDBC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       Connection conn = <span class="keyword">null</span>;</span><br><span class="line">       PreparedStatement psmt = <span class="keyword">null</span>;</span><br><span class="line">       ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       <span class="comment">// 1 加载驱动</span></span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">           <span class="comment">// 2 创建链接</span></span><br><span class="line">           conn = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">           <span class="comment">// 3 编写sql语句</span></span><br><span class="line">           String sql = <span class="string">&quot;select * from user where username=?&quot;</span>;</span><br><span class="line">           <span class="comment">// 4 预编译sql</span></span><br><span class="line">           psmt = conn.prepareStatement(sql);</span><br><span class="line">           <span class="comment">// 5 设置参数值</span></span><br><span class="line">           psmt.setString(<span class="number">1</span>, <span class="string">&quot;jisoo&quot;</span>);</span><br><span class="line">           <span class="comment">// 6 执行sql</span></span><br><span class="line">           rs = psmt.executeQuery();</span><br><span class="line">           <span class="comment">// 7 遍历结果集</span></span><br><span class="line">           <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">               <span class="comment">// 8 得到返回结果值</span></span><br><span class="line">               String username = rs.getString(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">               String password =  rs.getString(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">               <span class="comment">// 9 放到user对象里面</span></span><br><span class="line">               User user = <span class="keyword">new</span> User();</span><br><span class="line">               user.setUsername(username);</span><br><span class="line">               user.setPassword(password);</span><br><span class="line"></span><br><span class="line">               System.out.println(user);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">           <span class="comment">// 10 关闭链接</span></span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               rs.close();</span><br><span class="line">               psmt.close();</span><br><span class="line">               conn.close();</span><br><span class="line">           &#125; <span class="keyword">catch</span> (Exception throwables) &#123;</span><br><span class="line">               throwables.printStackTrace();</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<p>使用jdbcTemplate实现：</p>
<p><img src="/spring/2022-03-23_114842.png" alt="查询返回对象"></p>
<p>1）第一个参数是sql语句</p>
<p>2）第二个参数是 RowMapper，是接口，类似于dbutils里面接口</p>
<p>3）第三个参数是 可变参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//    3  查询返回对象</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 2 创建对象，设置数据库信息</span></span><br><span class="line">        DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 创建jdbcTemplate对象，设置数据源</span></span><br><span class="line">        JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 调用jdbcTemplate对象里面的方法实现操作</span></span><br><span class="line"><span class="comment">//        创建sql语句, 根据username查询</span></span><br><span class="line">        String sql = <span class="string">&quot;select * from user where username=?&quot;</span>;</span><br><span class="line">        <span class="comment">// 第二个参数是接口RowMapper，需要自己写类实现接口，自己做数据封装</span></span><br><span class="line">        User user = jdbcTemplate.queryForObject(sql, <span class="keyword">new</span> MyRowMapper(), <span class="string">&quot;lisa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyRowMapper</span> <span class="keyword">implements</span> <span class="title">RowMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">mapRow</span><span class="params">(ResultSet resultSet, <span class="keyword">int</span> i)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">// 1 从结果集里面把数据得到</span></span><br><span class="line">        String username = resultSet.getString(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String password = resultSet.getString(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        <span class="comment">// 2 把得到数据封装到对象里面去</span></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(username);</span><br><span class="line">        user.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>第三个 查询返回list集合</p>
<p><img src="/spring/2022-03-23_133621.png" alt="查询返回list集合"></p>
<p>1）sql语句</p>
<p>2）RowMapper接口，自己写类实现数据封装</p>
<p>3）可变参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//    4  查询返回list集合</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 2 创建对象，设置数据库信息</span></span><br><span class="line">        DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3 创建jdbcTemplate对象，设置数据源</span></span><br><span class="line">        JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4 调用jdbcTemplate对象里面的方法实现操作</span></span><br><span class="line"><span class="comment">//        创建sql语句, 根据username查询</span></span><br><span class="line">        String sql = <span class="string">&quot;select * from user&quot;</span>;</span><br><span class="line">        List&lt;User&gt; list = jdbcTemplate.query(sql,<span class="keyword">new</span> MyRowMapper());</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyRowMapper</span> <span class="keyword">implements</span> <span class="title">RowMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">mapRow</span><span class="params">(ResultSet resultSet, <span class="keyword">int</span> i)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="comment">// 1 从结果集里面把数据得到</span></span><br><span class="line">        String username = resultSet.getString(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String password = resultSet.getString(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        <span class="comment">// 2 把得到数据封装到对象里面去</span></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(username);</span><br><span class="line">        user.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="Spring配置连接池和dao使用jdbcTemplate"><a href="#Spring配置连接池和dao使用jdbcTemplate" class="headerlink" title="Spring配置连接池和dao使用jdbcTemplate"></a>Spring配置连接池和dao使用jdbcTemplate</h1><h2 id="spring配置c3p0连接池"><a href="#spring配置c3p0连接池" class="headerlink" title="spring配置c3p0连接池"></a><strong>spring配置c3p0连接池</strong></h2><p><strong>第一步 导入jar包</strong></p>
<p>c3p0-0.9.1.jar</p>
<p>mchange-commons-java-0.2.3.4.jar</p>
<p><strong>第二步 创建spring配置文件，配置连接池</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原始方式配置c3p0连接池</span></span><br><span class="line">ComboPooledDataSource dataSource = <span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">dataSource.setDriverClass(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">dataSource.setJdbcUrl(<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>);</span><br><span class="line">dataSource.setUser(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">dataSource.setPassword(<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>



<p>1）把代码在配置文件中进行配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    配置c3p0连接池--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    注入属性值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="dao使用jdbcTemplate"><a href="#dao使用jdbcTemplate" class="headerlink" title="dao使用jdbcTemplate"></a><strong>dao使用jdbcTemplate</strong></h2><p><strong>1 创建service和dao，配置service和dao对象，在service注入dao对象</strong></p>
<p><strong>2 创建jdbcTemplate对象，把模板对象注入到dao里面</strong></p>
<p><strong>3 在jdbcTemplate对象里面注入dataSource</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">&lt;!--    配置c3p0连接池--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--    注入属性值--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql:///spring_jdbc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    创建对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.demo.c3p0.UserDao&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--        注入dbcTemplate对象--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcTemplate&quot;</span>  <span class="attr">ref</span>=<span class="string">&quot;jdbcTemplate&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.demo.c3p0.UserService&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        注入dao对象--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    创建jdbcTemplate对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        把dataSource传入jdbcTemplate对象里面去--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="Spring的事务管理"><a href="#Spring的事务管理" class="headerlink" title="Spring的事务管理"></a>Spring的事务管理</h1><h2 id="事务概念"><a href="#事务概念" class="headerlink" title="事务概念"></a>事务概念</h2><p><strong>1 什么事务</strong></p>
<p> 事务是一个由有限操作集合组成的逻辑单元</p>
<p><strong>2 事务特性</strong></p>
<p> 原子性、一致性、隔离性、持久性</p>
<p><strong>3 不考虑隔离性产生读问题</strong></p>
<p> 脏读，一个事务处理过程里读取了另一个未提交的事务中的数据</p>
<p>幻读也叫虚读，一个事务执行两次查询，第二次结果集包含第一次中没有或某些行已经被删除的数据，造成两次结果不一致，是另一个事务在这两次查询中间插入或删除了数据造成的。幻读是事务非独立执行时发生的一种现象</p>
<p>不可重复读，一个事务两次读取同一行的数据，结果得到不同状态的结果，中间正好另一个事务更新了该数据，两次结果相异，不可被信任</p>
<p><strong>4 解决读问题</strong></p>
<p>1）设置隔离级别</p>
<h2 id="Spring事务管理api"><a href="#Spring事务管理api" class="headerlink" title="Spring事务管理api"></a>Spring事务管理api</h2><p><strong>1 spring事务管理两种方式</strong></p>
<p>第一种 编程式事务管理（不用）</p>
<p>第二种 声明式事务管理</p>
<p>（1）   基于xml配置文件实现</p>
<p>（2）   基于注解实现</p>
<p><strong>2 spring事务管理的api介绍</strong></p>
<p><img src="/spring/spring%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E7%9A%84api.png" alt="spring事务管理的api"></p>
<p>1）spring针对不同的dao层框架，提供接口不同的实现类</p>
<p><img src="/spring/%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%AE%9E%E7%8E%B0%E7%B1%BB.png" alt="事务管理实现类"></p>
<p>2）首先 配置事务管理器</p>
<h2 id="搭建转账环境"><a href="#搭建转账环境" class="headerlink" title="搭建转账环境"></a>搭建转账环境</h2><p><strong>1 创建数据库表，添加数据</strong></p>
<p><strong>2 创建service和dao类，完成注入关系</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    创建对象并注入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;ordersDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.demo.tx.dao.OrdersDao&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;jdbcTemplate&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;ordersService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.demo.tx.service.OrdersService&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;ordersDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;ordersDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>1）service层又叫业务逻辑层 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.tx.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.demo.tx.dao.OrdersDao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrdersService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> OrdersDao ordersDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrdersDao</span><span class="params">(OrdersDao ordersDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ordersDao = ordersDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用dao的方法</span></span><br><span class="line">    <span class="comment">// 业务逻辑层，写转账业务</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accountMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// lili少1000</span></span><br><span class="line">        ordersDao.lessMoney();</span><br><span class="line">        <span class="comment">// jiji多1000</span></span><br><span class="line">        ordersDao.moreMoney();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>2）dao层，单纯对数据库操作层，在dao层不添加业务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.demo.tx.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrdersDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注入jdbcTemplate对象</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJdbcTemplate</span><span class="params">(JdbcTemplate jdbcTemplate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jdbcTemplate = jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对数据库的操作</span></span><br><span class="line">    <span class="comment">// lili少钱的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lessMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;update account set salary=salary-? where username=?&quot;</span>;</span><br><span class="line">        jdbcTemplate.update(sql, <span class="number">1000</span>, <span class="string">&quot;lili&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// jiji多钱的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moreMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;update account set salary=salary+? where username=?&quot;</span>;</span><br><span class="line">        jdbcTemplate.update(sql, <span class="number">1000</span>, <span class="string">&quot;jiji&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>3）需求：小王 转账 1000 给 小马</p>
<p>小王少1000</p>
<p>小马多1000</p>
<p><strong>3 产生问题</strong></p>
<p>1）如果小王少了1000之后，出现异常，小马不会多1000，钱丢失了</p>
<p><strong>4 解决</strong></p>
<p>1）添加事务解决，出现异常进行回滚操作</p>
<h2 id="声明式事务管理（xml配置）"><a href="#声明式事务管理（xml配置）" class="headerlink" title="声明式事务管理（xml配置）"></a>声明式事务管理（xml配置）</h2><p><strong>配置文件方式使用aop思想配置</strong></p>
<p>第一步 配置事务管理器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    1 配置事务管理器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>第二步 配置事务增强</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    2 配置事务增强--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txadvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        做事务操作--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            设置进行事务操作的方法匹配规则--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;account*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>第三步 配置切面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    3 配置切面--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        切入点--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pointcut1&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.demo.tx.service.OrdersService.*(..))&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        切面--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txadvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:advisor</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>第四步 测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用dao的方法</span></span><br><span class="line"><span class="comment">// 业务逻辑层，写转账业务</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accountMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// lili少1000</span></span><br><span class="line">    ordersDao.lessMoney();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 出现异常</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// jiji多1000</span></span><br><span class="line">    ordersDao.moreMoney();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="声明式事务管理（注解）"><a href="#声明式事务管理（注解）" class="headerlink" title="声明式事务管理（注解）"></a>声明式事务管理（注解）</h2><p>第一步 配置事务管理器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    1 配置事务管理器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>第二步 开启事务注解</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    2 开启事务注解--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">tx:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>第三步 在要使用事务的方法所在类上面添加注解 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrdersService</span> </span>&#123;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">supertramp</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://supertramp7.github.io/spring/">https://supertramp7.github.io/spring/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://supertramp7.github.io" target="_blank">Supertramp</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ssh/">ssh</a><a class="post-meta__tags" href="/tags/java/">java</a><a class="post-meta__tags" href="/tags/spring/">spring</a><a class="post-meta__tags" href="/tags/%E6%A1%86%E6%9E%B6/">框架</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/struts2/"><img class="prev-cover" src="/struts2/struts2.png" onerror="onerror=null;src='/img/404.gif'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Struts2知识点</div></div></a></div><div class="next-post pull-right"><a href="/mybatis/"><img class="next-cover" src="/mybatis/mybatis.jpg" onerror="onerror=null;src='/img/404.gif'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">学习mybatis的一些坑</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/assets/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">supertramp</div><div class="author-info__description">You're being watched.</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/supertramp7" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">hello world!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring-%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">Spring 概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E7%9A%84ioc%E6%93%8D%E4%BD%9C"><span class="toc-number">2.</span> <span class="toc-text">Spring的ioc操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ioc%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.</span> <span class="toc-text">ioc底层原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ioc%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">2.2.</span> <span class="toc-text">ioc入门案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B2%A1%E6%9C%89%E6%8F%90%E7%A4%BA%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.</span> <span class="toc-text">配置文件没有提示问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E7%9A%84bean%E7%AE%A1%E7%90%86%EF%BC%88xml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">Spring的bean管理（xml配置文件）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#bean%E5%AE%9E%E4%BE%8B%E5%8C%96%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text">bean实例化三种方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bean%E6%A0%87%E7%AD%BE%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7"><span class="toc-number">3.2.</span> <span class="toc-text">bean标签常用属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5%E6%96%B9%E5%BC%8F%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.3.</span> <span class="toc-text">属性注入方式介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E6%B3%A8%E5%85%A5%E5%B1%9E%E6%80%A7%EF%BC%88%E6%9C%89%E5%8F%82%E6%9E%84%E9%80%A0%E5%92%8Cset%E6%96%B9%E6%B3%95%EF%BC%89"><span class="toc-number">3.4.</span> <span class="toc-text">Spring注入属性（有参构造和set方法）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E6%B3%A8%E5%85%A5%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">Spring注入对象类型属性（重点）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P%E5%90%8D%E7%A7%B0%E7%A9%BA%E9%97%B4%E6%B3%A8%E5%85%A5"><span class="toc-number">3.6.</span> <span class="toc-text">P名称空间注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E6%B3%A8%E5%85%A5%E5%A4%8D%E6%9D%82%E6%95%B0%E6%8D%AE"><span class="toc-number">3.7.</span> <span class="toc-text">Spring注入复杂数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IOC%E5%92%8CDI%E5%8C%BA%E5%88%AB"><span class="toc-number">3.8.</span> <span class="toc-text">IOC和DI区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E6%95%B4%E5%90%88web%E9%A1%B9%E7%9B%AE%E5%8E%9F%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">Spring整合web项目原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E7%9A%84bean%E7%AE%A1%E7%90%86%EF%BC%88%E6%B3%A8%E8%A7%A3%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">Spring的bean管理（注解）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87"><span class="toc-number">5.1.</span> <span class="toc-text">Spring注解开发准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1"><span class="toc-number">5.2.</span> <span class="toc-text">使用注解创建对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%B3%A8%E5%85%A5%E5%B1%9E%E6%80%A7"><span class="toc-number">5.3.</span> <span class="toc-text">使用注解注入属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xml%E5%92%8C%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E6%B7%B7%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">5.4.</span> <span class="toc-text">xml和注解方式混合使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AOP"><span class="toc-number">6.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E6%A6%82%E5%BF%B5"><span class="toc-number">6.1.</span> <span class="toc-text">AOP概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E5%8E%9F%E7%90%86"><span class="toc-number">6.2.</span> <span class="toc-text">AOP原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E6%93%8D%E4%BD%9C%E6%9C%AF%E8%AF%AD"><span class="toc-number">6.3.</span> <span class="toc-text">AOP操作术语</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spirng%E7%9A%84AOP%E6%93%8D%E4%BD%9C%EF%BC%88%E5%9F%BA%E4%BA%8Easpectj%E7%9A%84xml%E6%96%B9%E5%BC%8F%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">Spirng的AOP操作（基于aspectj的xml方式）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E6%93%8D%E4%BD%9C%E5%87%86%E5%A4%87"><span class="toc-number">7.1.</span> <span class="toc-text">AOP操作准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F%E9%85%8D%E7%BD%AE%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-number">7.2.</span> <span class="toc-text">使用表达式配置切入点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#log4j%E4%BB%8B%E7%BB%8D"><span class="toc-number">8.</span> <span class="toc-text">log4j介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E6%95%B4%E5%90%88web%E9%A1%B9%E7%9B%AE%E6%BC%94%E7%A4%BA"><span class="toc-number">9.</span> <span class="toc-text">Spring整合web项目演示</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spirng%E7%9A%84AOP%E6%93%8D%E4%BD%9C%EF%BC%88%E5%9F%BA%E4%BA%8Easpectj%E7%9A%84%E6%B3%A8%E8%A7%A3aop%EF%BC%89"><span class="toc-number">10.</span> <span class="toc-text">Spirng的AOP操作（基于aspectj的注解aop）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0aop%E6%93%8D%E4%BD%9C"><span class="toc-number">10.1.</span> <span class="toc-text">使用注解方式实现aop操作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E7%9A%84jdbcTemplate%E6%93%8D%E4%BD%9C"><span class="toc-number">11.</span> <span class="toc-text">Spring的jdbcTemplate操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0"><span class="toc-number">11.1.</span> <span class="toc-text">增加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9"><span class="toc-number">11.2.</span> <span class="toc-text">修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">11.3.</span> <span class="toc-text">删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2"><span class="toc-number">11.4.</span> <span class="toc-text">查询</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E9%85%8D%E7%BD%AE%E8%BF%9E%E6%8E%A5%E6%B1%A0%E5%92%8Cdao%E4%BD%BF%E7%94%A8jdbcTemplate"><span class="toc-number">12.</span> <span class="toc-text">Spring配置连接池和dao使用jdbcTemplate</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#spring%E9%85%8D%E7%BD%AEc3p0%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">12.1.</span> <span class="toc-text">spring配置c3p0连接池</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dao%E4%BD%BF%E7%94%A8jdbcTemplate"><span class="toc-number">12.2.</span> <span class="toc-text">dao使用jdbcTemplate</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spring%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">13.</span> <span class="toc-text">Spring的事务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E6%A6%82%E5%BF%B5"><span class="toc-number">13.1.</span> <span class="toc-text">事务概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86api"><span class="toc-number">13.2.</span> <span class="toc-text">Spring事务管理api</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E8%BD%AC%E8%B4%A6%E7%8E%AF%E5%A2%83"><span class="toc-number">13.3.</span> <span class="toc-text">搭建转账环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%88xml%E9%85%8D%E7%BD%AE%EF%BC%89"><span class="toc-number">13.4.</span> <span class="toc-text">声明式事务管理（xml配置）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%88%E6%B3%A8%E8%A7%A3%EF%BC%89"><span class="toc-number">13.5.</span> <span class="toc-text">声明式事务管理（注解）</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/accumulate/" title="积	累"><img src="/assets/default-banner.jpg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="积	累"/></a><div class="content"><a class="title" href="/accumulate/" title="积	累">积	累</a><time datetime="2022-04-25T02:20:55.000Z" title="发表于 2022-04-25 10:20:55">2022-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ssh/" title="ssh整合"><img src="/ssh/ssh.jpg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="ssh整合"/></a><div class="content"><a class="title" href="/ssh/" title="ssh整合">ssh整合</a><time datetime="2022-03-17T11:38:50.000Z" title="发表于 2022-03-17 19:38:50">2022-03-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/hibernate/" title="Hibernate知识点"><img src="/hibernate/hibernate.png" onerror="this.onerror=null;this.src='/img/404.gif'" alt="Hibernate知识点"/></a><div class="content"><a class="title" href="/hibernate/" title="Hibernate知识点">Hibernate知识点</a><time datetime="2022-03-10T17:09:09.000Z" title="发表于 2022-03-11 01:09:09">2022-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/struts2/" title="Struts2知识点"><img src="/struts2/struts2.png" onerror="this.onerror=null;this.src='/img/404.gif'" alt="Struts2知识点"/></a><div class="content"><a class="title" href="/struts2/" title="Struts2知识点">Struts2知识点</a><time datetime="2022-03-10T17:08:48.000Z" title="发表于 2022-03-11 01:08:48">2022-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/spring/" title="Spring知识点"><img src="/spring/spring.png" onerror="this.onerror=null;this.src='/img/404.gif'" alt="Spring知识点"/></a><div class="content"><a class="title" href="/spring/" title="Spring知识点">Spring知识点</a><time datetime="2022-03-08T00:54:30.000Z" title="发表于 2022-03-08 08:54:30">2022-03-08</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/spring/spring.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By supertramp</div><div class="footer_custom_text">boring</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div></div><!-- hexo injector body_end start --><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content" sc><div id="hexo_electric_clock"><img id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            electric_clock_injector_config()
        } </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax  src="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.js"></script><!-- hexo injector body_end end --></body></html>